<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Rückmeldung</title>
  <style>
    body {
      background-color: #1e1e2f;
      color: white;
      font-family: Arial, sans-serif;
      padding: 2rem;
    }
    .mitglied {
      background-color: #2e2e3f;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      padding: 1rem;
    }
    .mitglied-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      cursor: pointer;
    }
    .mitglied-header img {
      border-radius: 50%;
      width: 48px;
      height: 48px;
    }
    .feedback-container {
      margin-top: 1rem;
    }
    .feedback-list {
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }
    textarea {
      width: 100%;
      padding: 0.5rem;
      background: #333;
      color: white;
      border: none;
      border-radius: 4px;
      resize: vertical;
    }
    button {
      margin-top: 0.5rem;
      background: #5865F2;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Rückmeldung</h1>
  <div id="liste"></div>

  <script>
    const webhookUrl = "https://discord.com/api/webhooks/1392150424097915042/RQoNPfTIxyP7XUNJdOOHptgWWaKSDl6C8jh13puHQ3xcX7aWuDjaG5wHoE8PtV7c8QLa";

    const testMitglieder = [
      {
        id: "1",
        name: "Max Mustermann",
        avatar: "https://cdn.discordapp.com/embed/avatars/0.png"
      }
    ];

    const discordUser = { username: "kommebald" };

    const liste = document.getElementById("liste");

    testMitglieder.forEach(user => {
      const block = document.createElement("div");
      block.className = "mitglied";

      const header = document.createElement("div");
      header.className = "mitglied-header";
      header.innerHTML = `<img src="${user.avatar}"><strong>${user.name}</strong>`;
      block.appendChild(header);

      let feedbackBox = null;

      header.addEventListener("click", () => {
        if (feedbackBox) {
          feedbackBox.remove();
          feedbackBox = null;
          return;
        }

        feedbackBox = document.createElement("div");
        feedbackBox.className = "feedback-container";

        const list = document.createElement("div");
        list.className = "feedback-list";
        list.innerHTML = "<em>Keine Feedbacks</em>";

        const input = document.createElement("textarea");
        input.placeholder = "Feedback schreiben...";

        const send = document.createElement("button");
        send.textContent = "Absenden";

        send.onclick = () => {
          const msg = input.value.trim();
          if (!msg) return;

          const eintrag = `${discordUser.username}: ${msg}`;
          list.innerHTML += `<br>• ${eintrag}`;
          input.value = "";

          fetch(webhookUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ content: `**Feedback für ${user.name}:**\n> ${eintrag}` })
          });
        };

        feedbackBox.appendChild(list);
        feedbackBox.appendChild(input);
        feedbackBox.appendChild(send);
        block.appendChild(feedbackBox);
      });

      liste.appendChild(block);
    });
  </script>
</body>
</html>
